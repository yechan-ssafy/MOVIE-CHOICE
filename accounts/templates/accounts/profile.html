{% extends 'base.html' %}

{% block content %}
<div class="container">
  <h1 class="text-center font02">{{ person.username }}님의 프로필</h1>

  {% include 'accounts/_follow.html' %}

  <hr>

  <h2 class="font02">나의 활동</h2>
    <div class="card-group">
      <div class="card card-primary text-center">
        <img class="card-img-top" src="https://static3.avast.com/10001215/web/i/index2/for-home.jpg" alt="Card image cap">
        <div class="card-body">
          <div class="badge badge-primary badge-sm">REVIEW</div>
          <div class="card-title"><h2 class="font03">{{ person.username }}가 쓴 글</h2></div>
          {% for review in person.review_set.all %}
            <p class="card-text">{{ review.title }}</p>
          {% endfor %}
        </div>
        <div class="card-footer">
        </div>
      </div>
      <div class="card card-primary text-center">
        <img class="card-img-top" src="https://static3.avast.com/10001215/web/i/index2/for-partners.jpg" alt="Card image cap">
        <div class="card-body">
          <div class="badge badge-primary badge-sm">COMMENT</div>
          <div class="card-title"><h2 class="font03">{{ person.username }}가 쓴 댓글</h2></div>
          {% for comment in person.comment_set.all %}
            <p class="card-text">{{ comment.content }}</p>
          {% endfor %}
        </div>
        <div class="card-footer">
          
        </div>
      </div>
      <div class="card card-primary text-center">
        <img class="card-img-top" src="https://static3.avast.com/10001215/web/i/index2/for-business.jpg" alt="Card image cap">
        <div class="card-body">
          <div class="badge badge-primary badge-sm">LIKES</div>
          <div class="card-title"><h2 class="font03">{{ person.username }}가 좋아요한 글</h2></div>          
          {% for review in person.like_reviews.all %}
            <p class="card-text">{{ review.title }}</p>
          {% endfor %}
        </div>
        <div class="card-footer">
        
        </div>
      </div>
    </div>

  {% comment %} <h2>{{ person.username }}가 쓴 글</h2>
  {% for review in person.review_set.all %}
    <div>{{ review.title }}</div>
  {% endfor %}

  <hr>

  <h2>{{ person.username }}가 쓴 댓글</h2>
  {% for comment in person.comment_set.all %}
    <div>{{ comment.content }}</div>
  {% endfor %}
  
  <hr>

  <h2>{{ person.username }}가 좋아요한 글</h2>
  {% for review in person.like_reviews.all %}
    <div>{{ review.title }}</div>
  {% endfor %}

  <hr> {% endcomment %}

  <a href="{% url 'community:index' %}">[back]</a>
  {% endblock  %}

  {% block script %}
    <script>
      const followForm = document.querySelector('#follow-form')
      const userPk = followForm.dataset.userpk

      followForm.addEventListener('submit', function (e) {
        e.preventDefault()

        const API_URL = `/accounts/follow/${userPk}/`
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value
        const options = {headers: {'X-CSRFToken': csrfToken}}
        axios.post(API_URL, {}, options)
          .then(res => {
            const { is_follow, following_count, follower_count } = res.data

            const followBtn = document.querySelector('#follow-form > button')

            followBtn.classList.toggle('btn-primary')
            followBtn.classList.toggle('btn-secondary')

            followBtn.innerText = is_follow ? 'Unfollow' : 'Follow'

            const followCount = document.querySelector('#follow-count')
            followCount.innerText = `팔로잉 : ${following_count} / 팔로워 : ${follower_count}`
          })
          .catch(err => {
            console.error(err)
          })
      })
    </script>
</div>

{% block style %}
<style>
  .card {
    border:0;
  }


  /* card group aka PRIMARY */
  .card-group .card-primary:hover {
    box-shadow: 0 40px 60px -20px rgba(12, 5, 62, 0.15);
    z-index: 100;
  }
  .card-group .card-primary:hover .card-title{
    color: #4e22d0;
  }
  .card-group .card-primary .card-img-top{
    width:100px;
    height:100px;
    margin: 30px auto 32px;
  }
  .card-group .card-primary .card-body > .badge {
    margin-bottom: 24px;
  }
  .card-group .card-primary .card-body {
    padding: 0 32px;
  }
  .card-group .card-primary .card-title {
    color: #261c6a;
    font-size: 26px;
    line-height: 1.54;
    font-weight: 900;
    margin-bottom: 24px;
  }
  .card-group .card-primary .card-text {
    color: #261c6a;
    font-size: 16px;
    line-height: 1.5;
    font-weight: 400;
  }
  .card-group .card-primary .card-footer {
    padding: 48px 0 56px;
    background: transparent;
    border:0;
  }


  /* card deck aka SECONDARY */

  .card-deck .card-secondary {
    padding: 32px 32px 0;
    margin: 16px;
    border-radius: 0;
  }
  .card-deck .card-secondary:hover {
    box-shadow: 0 40px 60px -20px rgba(12, 5, 62, 0.15);
  }
  .card-deck .card-secondary:hover .card-title{
    color: #4e22d0;
  }
  .card-deck .card-secondary .card-body {
    padding: 0;
  }
  .card-deck .card-secondary .card-img-top{
    margin-bottom: 24px;
    border-radius: 0px;
  }
  .card-deck .card-secondary .card-title {
    color: #261c6a;
    font-size: 20px;
    line-height: 1.6;
    font-weight: 700;
    margin-bottom: 16px;
  }
  .card-deck .card-secondary .card-text {
    color: #261c6a;
    font-size: 14px;
    line-height: 1.71;
    font-weight: 400;
    margin-bottom: 16px;
  }
  .card-deck .card-secondary .card-footer {
    padding: 9px 0 25px;
    background: transparent;
    border:0;
  }
  .card-deck .card-secondary .card-footer .btn{
    margin-right: -24px;
  }


  /* card AWARDS */
  .awards-container {
    background-image: linear-gradient(to bottom, #0c053e 2%, #261c6a);
    margin: 0 -30px;
    padding: 30px;
  }
  .awards-container h2 {
    color: #fff;
  }
  .card-deck > .card-awards {
    padding: 32px 32px 0;
    margin: 16px;
    border-radius: 0;
    background: transparent;
  }
  .card-deck .card-awards:hover {
    box-shadow: 0 40px 60px -20px rgba(8, 4, 43, 0.8);
    background-color: #261c6a;
  }
  .card-deck .card-awards:hover .card-footer .btn{
    visibility: visible;
  }

  .card-deck > .card-awards .card-body {
    padding: 0;
  }
  .card-deck > .card-awards .card-img-top{
    margin-bottom: 24px;
    border-radius: 0px;
    height: 80px;
    display: flex; justify-content: center;
  }
  .card-deck .card-awards .card-img-top img {
    margin: auto;
  }
  .card-deck .card-awards .card-title {
    color: #fff;
    font-size: 16px;
    line-height: 1.5;
    font-weight: 400;
    margin-bottom: 3px;
  }
  .card-deck .card-awards .card-footer {
    padding: 9px 0 13px;
    border:0;
  }
  .card-deck .card-awards .card-footer .btn{
    color: #fff;
    visibility: hidden;
  }

  /* cards as ACCORDION */
  .accordion-container{
    margin: 50px 0;
  }
  .accordion {
    margin: 24px 100px;
    box-shadow: 0 40px 60px -20px rgba(12, 5, 62, 0.15);
    border: solid 1px #e9e8f3;
  }
  .accordion .card {
    border-radius: 0;
    margin:0;
  }

  .accordion .card:first-child {
    border-bottom: solid 1px #e9
  </style>
{% endblock %}
{% endblock %}
